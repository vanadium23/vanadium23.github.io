






<!DOCTYPE html>
<html lang="ru-ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>
    
    Stupid mistakes with database | vanadium23
    
  </title>
  
  
  <link rel="stylesheet" href="https://vanadium23.me/css/base.min.34ac18bc3a855e272b475cf37b39ff5a4782c6c135d52b81107686678deaa01a.css" integrity="sha256-NKwYvDqFXicrR1zzezn/WkeCxsE11SuBEHaGZ43qoBo=">
  
  <link rel="stylesheet" href="/css/style.css">

  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <meta name="theme-color" content="#ffffff">
  
  
  <meta name="generator" content="Hugo 0.54.0" />
</head>
<body>
  <nav class="u-background">
    <div class="u-wrapper">
        <ul class="Banner">
            <li class="Banner-item Banner-item--title">
                <a class="Banner-link u-clickable" href="https://vanadium23.me/">
                    vanadium23
                </a>
            </li>
        
        <li class="Banner-item">
            <a class="Banner-link u-clickable" href="https://vanadium23.me/tags/dev/">Dev (Eng)</a>
        </li>
        
        <li class="Banner-item">
            <a class="Banner-link u-clickable" href="https://vanadium23.me/about">About</a>
        </li>
        
        <li class="Banner-item">
            <a class="Banner-link u-clickable" href="https://vanadium23.me/tags/">Tags</a>
        </li>
        
        </ul>
    </div>
</nav>
  <main>
    <div class="u-wrapper">
      <div class="u-padding">
        

<article>
  <header class="Heading">
  <h2 class="Heading-title">
    <a class="Heading-link u-clickable" href="https://vanadium23.me/stupid-database-mistakes/" rel="bookmark">Stupid mistakes with database</a>
  </h2>
  
  <time datetime="2017-09-02T17:00:00&#43;03:00">
    2 September, 2017
  </time>
  
</header>
  <p>You know you&rsquo;re wrong at database administrating, when&hellip;</p>

<h2 id="1-don-t-monitor-free-space-on-disk">1. Don&rsquo;t monitor free space on disk</h2>

<p><strong>DO:</strong> Just do it, and not some simple trigger on 10% free left space, but either how many days till day X.</p>

<h2 id="2-don-t-make-check-backups">2. Don&rsquo;t <del>make</del> check backups</h2>

<p>So you use some tools for backing up your database, but when day X comes, you can not restore from it.</p>

<p><strong>DO:</strong> every backup needs to be restored.</p>

<h2 id="3-don-t-monitor-slowest-frequent-queries">3. Don&rsquo;t monitor slowest/frequent queries</h2>

<p><strong>DO:</strong> there is different approaches for that, but the simplest one is <a href="https://github.com/dalibo/pgbadger">pgBadger</a> with syslog.</p>

<h2 id="4-don-t-use-int4-as-pk-for-append-only-tables">4. Don&rsquo;t use int4 as pk for append-only tables</h2>

<p><strong>DO:</strong> just use bigint. Rails make bigint as default for pk in <a href="http://www.mccartie.com/2016/12/05/rails-5.1.html">5.1</a>. Hopefully, Django will make it in 2.x.</p>

<h2 id="5-don-t-restart-database-on-every-error-you-see">5. Don&rsquo;t restart database on every error you see.</h2>

<p><strong>DO:</strong> hire DBA (just joking). Try to find a root cause with your monitoring. May be it&rsquo;s just bad statics on table and you need to run <code>ANALYSE table</code>.</p>
  
<footer>
  <ul class="Tags">
    
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="https://vanadium23.me/tags/database/" rel="tag">database</a>
    </li>
    
    
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="https://vanadium23.me/tags/monitoring/" rel="tag">monitoring</a>
    </li>
    
    
    
    
    <li class="Tags-item u-background">
      <a class="Tags-link u-clickable" href="https://vanadium23.me/tags/dev/" rel="tag">dev</a>
    </li>
    
    
  </ul>
</footer>

</article>


      </div>
    </div>
  </main>
  
<footer class="Footer">
  <div class="u-wrapper">
    <div class="u-padding">
        
        <a href="https://github.com/vanadium23"><i class="svg-icon github"></i></a>
        <a href="https://www.linkedin.com/in/vanadium23"><i class="svg-icon linkedin"></i></a>
        <a href="https://www.twitter.com/vanadium23"><i class="svg-icon twitter"></i></a>
        <a href="http://stackoverflow.com/users/4809450/vanadium23"><i class="svg-icon stackoverflow"></i></a>
        <a href="https://www.codewars.com/users/vanadium23"><i class="svg-icon codewars"></i></a>
    </div>
  </div>
</footer>

  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-63836742-2', 'auto');
      ga('send', 'pageview');
  </script>
</body>
</html>